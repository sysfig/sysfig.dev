<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noindex"><title>- sysfig</title><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel=stylesheet><link rel=stylesheet href=https://sysfig.dev/style.css></head><body><header><div id=menu-button></div><nav id=main-nav><a class=main-nav__link href=/series>Series</a>
<a class=main-nav__link href=/posts>Posts</a>
<a id=main-nav__home-link class=main-nav__link href=/><span id=header-text-logo>sysfig.dev</span><div id=header-logo class=logo></div></a><a class=main-nav__link href=/projects>Projects</a>
<a class=main-nav__link href=/now>Now</a></nav></header><main><div class="single series-post"><h1 class=title></h1><div class=page-meta>// 1 Jan 01</div><div class=series-post-header>This post is part of the series .</div><div class=content><h3 id=testing-multiple-scenarios>Testing Multiple Scenarios</h3><p>It&rsquo;s good practice to have one test routine for one function. ??How does different scenarios of the same test work then??</p><p>sub-tests</p><h2 id=integration-testing>Integration Testing</h2><p>go help test
go help testflag - flags that control execution of the test</p><p>go help testfunc</p><h3 id=test-data>Test Data</h3><p>The <code>go</code> tool will ignore any directories named <code>testdata</code>, which we can use to hold test data.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>file</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;./testdata/users.csv&#34;</span>)
<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
  <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
}
<span style=color:#75715e>// Do something with the file
</span></code></pre></div><p>A test fixture is a clean, fixed, and well-defined environment within which tests run so that tests results are reliably repeatable. You can set up a test fixture by:</p><ul><li>running test suites on a clean container</li><li>wiping/deleting the output directory and databases which may contain artefacts from the previous test run, this resets the environment to its original state.</li><li>loading sample data the tests will consume into a database</li><li>copying a set of sample files that the tests will consume</li></ul><p>If you used testing frameworks before, you typically set up your test fixture in functions called <code>setup</code>, <code>before</code>/<code>beforeAll</code> and resets your fixture using functions called <code>teardown</code>, <code>after</code>/<code>afterAll</code>.</p><h2 id=testing-mutliple-packages>Testing Mutliple Packages</h2><p>Running tests on files in the current directory using <code>go test</code> (with no arguments) is known as <em>local directory mode</em>. We can also explicitly specify a package or packages (i.e. directories) for <code>go test</code> to test; when we do, it&rsquo;s called <em>package list mode</em>. For example:</p><ul><li><code>go test .</code> - test the package in the current directory</li><li><code>go test ./math</code> - test the package in the <code>./math</code> directory</li><li><code>go test math</code> - test the <code>math</code> module that is found in <code>$GOPATH</code></li><li><code>go test ./...</code> - (ran within a module directory containing packages) test all packages in this module</li></ul><p>If we are testing multiple packages, the results of each package would be listed, as well as the result of the entire test run.</p><p>When testing packages in package list mode, <code>go test</code> will cache all successful package tests that was invoked using a test command that uses only a limited subset of &lsquo;cacheable&rsquo; test flags (<code>-cpu</code>, <code>-list</code>, <code>-parallel</code>, <code>-run</code>, <code>-short</code>, and <code>-v</code>). On subsequent runs, if any of the package source files have not changed, <code>go test</code> will use the cached results instead of re-running the tests, and the output will display <code>(cached)</code> instead of the elaspsed time in the summary line.</p><h2 id=tips>Tips</h2><h3 id=running-a-subset-of-tests>Running a Subset of Tests</h3><p><code>go test</code> has a <code>-run</code> option which allows you to only run test routines whose names matches a regular expression pattern. So <code>go test -run TestFactorial</code> will run <code>TestFactorial/??</code> and <code>TestFactorial/??</code>.</p><h2 id=test-packages>Test Packages</h2><h3 id=mocks>Mocks</h3><p><a href=https://golang.org/pkg/net/http/httptest/>https://golang.org/pkg/net/http/httptest/</a>
<a href=https://golang.org/pkg/testing/iotest/>https://golang.org/pkg/testing/iotest/</a></p><p><a href=https://github.com/rakyll/gotest>https://github.com/rakyll/gotest</a> - <code>go test</code> but the output is colored
<a href=https://github.com/cweill/gotests>https://github.com/cweill/gotests</a> - test boilerplate generator
(2) <a href=https://github.com/stretchr/testify>https://github.com/stretchr/testify</a> - assert</p></div><div id=series-navigation><a class=prev href=/series/golang/useful-packages/><div class=prev-button><img class=prev__arrow src=/img/arrow.svg><span class=prev__text>Prev</span></div><div class=prev__title><div class=chapter-order>Z99</div><div class=prev__title__text>Useful Packages</div></div></a><a class=next href=/series/golang/z99_black-vs-white-box-testing/><div class=next-button><span class=next__text>Next</span><img class=next__arrow src=/img/arrow.svg></div><div class=next__title><div class=prev__title__text></div><div class=chapter-order></div></div></div></div></main><footer><a href=/><div id=footer-logo-group><div id=footer-logo-base-rect></div><div id=footer-logo-base-circle></div><div id=footer-logo class=logo></div><div id=footer-text><span class=text-logo>sysfig.dev</span>
<span class=copyright>2021</span></div></div></a><div id=footer-about>I am a programmer and DevOps engineer on a quest to make education more accessible for all. <span class=text-logo>sysfig.dev</span> is an outlet for me to share my knowledge on the web, and also to showcase my projects.</div></footer><script src=/js/main.js></script></body></html>